import{r as I,u as A,t as u,s as M,j as s}from"./index-gX9iSPDQ.js";import{z as g,u as h,s as w,F as f,a as n,b as t,c as i,d as c,I as l,e as m}from"./index-Cc5_sMEQ.js";import{h as L,L as k,R as B}from"./apiConstants-BiX1T2IA.js";import{B as y}from"./createLucideIcon-W0Ra_zwb.js";import{T as V,a as _,b,c as F}from"./tabs-CKzWU6B3.js";import{p as E,e as N}from"./common.schema-BgVe_du5.js";import{u as P}from"./useMutation-DC5Y5oj9.js";import{L as S}from"./loader-circle-BohTAJjK.js";import"./index-DVAmEPTK.js";async function G(r,a){return(await L.post(B,{email:r,password:a})).data}async function K(r,a){return(await L.post(k,{email:r,password:a})).data}const U=g.object({email:N,password:E}),z=g.object({email:N,password:E,confirmPassword:g.string()}).refine(r=>r.password===r.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function O(){const[r,a]=I.useState("login"),x=A(),d=h({resolver:w(U),defaultValues:{email:"",password:""}}),o=h({resolver:w(z),defaultValues:{email:"",password:"",confirmPassword:""}}),{mutateAsync:v,isPending:j}=P({mutationKey:["user/login"],mutationFn:async e=>await K(e.email,e.password),onSuccess:e=>{u.success(e.message),M("token",e.access_token),x.navigate({to:"/audio-upload"})},onError:e=>{u.error(e instanceof Error?e.message:"Login failed")}});async function R(e){await v(e)}const{mutateAsync:C,isPending:p}=P({mutationKey:["user/register"],mutationFn:async e=>await G(e.email,e.password),onSuccess:e=>{u.success(e.message),a("login")},onError:e=>{u.error(e instanceof Error?e.message:"Registration failed")}});async function T(e){await C(e)}return s.jsx("div",{className:"space-y-6",children:s.jsxs(V,{className:"w-full",onValueChange:e=>a(e),value:r,children:[s.jsxs(_,{className:"grid w-full grid-cols-2",children:[s.jsx(b,{value:"login",children:"Login"}),s.jsx(b,{value:"register",children:"Register"})]}),s.jsx(F,{value:"login",children:s.jsx(f,{...d,children:s.jsxs("form",{onSubmit:d.handleSubmit(R),className:"space-y-4",children:[s.jsx(n,{control:d.control,name:"email",render:({field:e})=>s.jsxs(t,{children:[s.jsx(i,{children:"Email"}),s.jsx(c,{children:s.jsx(l,{placeholder:"Enter your email",...e})}),s.jsx(m,{})]})}),s.jsx(n,{control:d.control,name:"password",render:({field:e})=>s.jsxs(t,{children:[s.jsx(i,{children:"Password"}),s.jsx(c,{children:s.jsx(l,{type:"password",placeholder:"Enter your password",...e})}),s.jsx(m,{})]})}),s.jsx(y,{type:"submit",className:"w-full",disabled:j||p,children:j?s.jsxs(s.Fragment,{children:[s.jsx(S,{className:"mr-2 h-4 w-4 animate-spin"}),"Logging in..."]}):"Login"})]})})}),s.jsx(F,{value:"register",children:s.jsx(f,{...o,children:s.jsxs("form",{onSubmit:o.handleSubmit(T),className:"space-y-4",children:[s.jsx(n,{control:o.control,name:"email",render:({field:e})=>s.jsxs(t,{children:[s.jsx(i,{children:"Email"}),s.jsx(c,{children:s.jsx(l,{placeholder:"Enter your email",...e})}),s.jsx(m,{})]})}),s.jsx(n,{control:o.control,name:"password",render:({field:e})=>s.jsxs(t,{children:[s.jsx(i,{children:"Password"}),s.jsx(c,{children:s.jsx(l,{type:"password",placeholder:"Create a password",...e})}),s.jsx(m,{})]})}),s.jsx(n,{control:o.control,name:"confirmPassword",render:({field:e})=>s.jsxs(t,{children:[s.jsx(i,{children:"Confirm Password"}),s.jsx(c,{children:s.jsx(l,{type:"password",placeholder:"Confirm your password",...e})}),s.jsx(m,{})]})}),s.jsx(y,{type:"submit",className:"w-full",disabled:p,children:p?s.jsxs(s.Fragment,{children:[s.jsx(S,{className:"mr-2 h-4 w-4 animate-spin"}),"Registering..."]}):"Register"})]})})})]})})}const $=function(){return s.jsx("div",{className:"bg-background flex min-h-screen items-center justify-center p-4",children:s.jsxs("div",{className:"bg-card w-full max-w-md space-y-6 rounded-xl p-8 shadow-lg",style:{marginBottom:"150px"},children:[s.jsx("h2",{className:"text-foreground text-center text-3xl font-bold",children:"Log in to your account"}),s.jsx(O,{})]})})};export{$ as component};
